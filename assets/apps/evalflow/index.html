<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EvalFlow - Peer Evaluation System</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
    import { getFirestore, collection, addDoc, updateDoc, deleteDoc, getDocs, query, where, doc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
    
    const firebaseConfig = {
      apiKey: "AIzaSyDbAgwMiEAZCezKy3t7j4ZW8xQyjgXqrKI",
      authDomain: "evalflow-b3da2.firebaseapp.com",
      projectId: "evalflow-b3da2",
      storageBucket: "evalflow-b3da2.firebasestorage.app",
      messagingSenderId: "376143096721",
      appId: "1:376143096721:web:8399e278170f1c3f4f8830",
      measurementId: "G-CRL51V7SZL"
    };
    
    const app = initializeApp(firebaseConfig);
    window.auth = getAuth(app);
    window.db = getFirestore(app);
    window.firebaseAuth = { signInWithEmailAndPassword, signOut, onAuthStateChanged };
    window.firebaseFirestore = { collection, addDoc, updateDoc, deleteDoc, getDocs, query, where, doc, serverTimestamp };
  </script>
  
  <style>
    body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script>
    const { useState, useEffect } = React;
    
    // Icon Components
    const Trash2 = ({ size = 20, className = "" }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2", strokeLinecap: "round", strokeLinejoin: "round", className },
        React.createElement('polyline', { points: "3 6 5 6 21 6" }),
        React.createElement('path', { d: "M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" })
      )
    );
    
    const X = ({ size = 20 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('line', { x1: "18", y1: "6", x2: "6", y2: "18" }),
        React.createElement('line', { x1: "6", y1: "6", x2: "18", y2: "18" })
      )
    );
    
    const Upload = ({ size = 20 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('path', { d: "M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" }),
        React.createElement('polyline', { points: "17 8 12 3 7 8" }),
        React.createElement('line', { x1: "12", y1: "3", x2: "12", y2: "15" })
      )
    );
    
    const FileDown = ({ size = 20 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('path', { d: "M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" }),
        React.createElement('polyline', { points: "14 2 14 8 20 8" }),
        React.createElement('path', { d: "M12 18v-6" }),
        React.createElement('path', { d: "M9 15l3 3 3-3" })
      )
    );
    
    const LogOut = ({ size = 20 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('path', { d: "M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" }),
        React.createElement('polyline', { points: "16 17 21 12 16 7" }),
        React.createElement('line', { x1: "21", y1: "12", x2: "9", y2: "12" })
      )
    );
    
    const Users = ({ size = 24 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('path', { d: "M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" }),
        React.createElement('circle', { cx: "9", cy: "7", r: "4" }),
        React.createElement('path', { d: "M22 21v-2a4 4 0 0 0-3-3.87" }),
        React.createElement('path', { d: "M16 3.13a4 4 0 0 1 0 7.75" })
      )
    );
    
    const BarChart3 = ({ size = 24 }) => (
      React.createElement('svg', { xmlns: "http://www.w3.org/2000/svg", width: size, height: size, viewBox: "0 0 24 24", fill: "none", stroke: "currentColor", strokeWidth: "2" },
        React.createElement('path', { d: "M3 3v18h18" }),
        React.createElement('path', { d: "M18 17V9" }),
        React.createElement('path', { d: "M13 17V5" }),
        React.createElement('path', { d: "M8 17v-3" })
      )
    );

    function EvalFlow() {
      const [currentUser, setCurrentUser] = useState(null);
      const [userRole, setUserRole] = useState(null);
      const [loading, setLoading] = useState(true);
      const [view, setView] = useState('login');
      const [courses, setCourses] = useState([]);
      const [sections, setSections] = useState([]);
      const [students, setStudents] = useState([]);
      const [groups, setGroups] = useState([]);
      const [evaluations, setEvaluations] = useState([]);
      const [selectedCourse, setSelectedCourse] = useState(null);
      const [selectedSection, setSelectedSection] = useState(null);
      const [loginEmail, setLoginEmail] = useState('');
      const [loginPassword, setLoginPassword] = useState('');
      const [studentName, setStudentName] = useState('');
      const [studentEmail, setStudentEmail] = useState('');
      const [courseName, setCourseName] = useState('');
      const [sectionName, setSectionName] = useState('');
      const [presentationScores, setPresentationScores] = useState({});
      const [groupScores, setGroupScores] = useState({});
      const [submittedEvals, setSubmittedEvals] = useState(new Set());
      const [activeTab, setActiveTab] = useState('courses');
      const [showPassword, setShowPassword] = useState(false);
      const [error, setError] = useState('');
      const [success, setSuccess] = useState('');
      const [deleteConfirm, setDeleteConfirm] = useState(null);
      
      // Bulk import state
      const [showBulkImport, setShowBulkImport] = useState(false);
      const [importFile, setImportFile] = useState(null);
      const [importPreview, setImportPreview] = useState([]);
      const [importing, setImporting] = useState(false);
      const [importProgress, setImportProgress] = useState('');

      useEffect(() => {
        const unsubscribe = window.firebaseAuth.onAuthStateChanged(window.auth, (user) => {
          if (user) {
            setCurrentUser(user);
            setUserRole('instructor');
            setView('dashboard');
            loadInstructorData(user.uid);
          } else {
            setCurrentUser(null);
            setUserRole(null);
          }
          setLoading(false);
        });
        return unsubscribe;
      }, []);

      const loadInstructorData = async (uid) => {
        try {
          const { collection, getDocs, query, where } = window.firebaseFirestore;
          
          const coursesRef = collection(window.db, 'courses');
          const coursesQuery = query(coursesRef, where('instructorId', '==', uid));
          const coursesSnap = await getDocs(coursesQuery);
          const coursesData = coursesSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setCourses(coursesData);

          const sectionsRef = collection(window.db, 'sections');
          const sectionsSnap = await getDocs(sectionsRef);
          const sectionsData = sectionsSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setSections(sectionsData);

          const studentsRef = collection(window.db, 'students');
          const studentsSnap = await getDocs(studentsRef);
          const studentsData = studentsSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setStudents(studentsData);

          const groupsRef = collection(window.db, 'groups');
          const groupsSnap = await getDocs(groupsRef);
          const groupsData = groupsSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setGroups(groupsData);

          const evalsRef = collection(window.db, 'evaluations');
          const evalsSnap = await getDocs(evalsRef);
          const evalsData = evalsSnap.docs.map(doc => ({ id: doc.id, ...doc.data() }));
          setEvaluations(evalsData);
        } catch (err) {
          console.error('Error loading data:', err);
          setError('Failed to load data');
        }
      };

      const handleInstructorLogin = async (e) => {
        e.preventDefault();
        setError('');
        try {
          await window.firebaseAuth.signInWithEmailAndPassword(window.auth, loginEmail, loginPassword);
        } catch (err) {
          setError('Login failed: ' + err.message);
        }
      };

      const handleStudentLogin = async (e) => {
        e.preventDefault();
        setError('');
        
        if (!studentName || !studentEmail || !selectedSection) {
          setError('Please fill in all fields');
          return;
        }
        
        const student = students.find(s => 
          s.email.toLowerCase() === studentEmail.toLowerCase() && 
          s.sectionId === selectedSection
        );
        
        if (!student) {
          setError('Student not found in this section');
          return;
        }

        const studentEvals = evaluations.filter(e => e.evaluatorEmail === studentEmail);
        const alreadySubmitted = new Set(studentEvals.map(e => `${e.type}-${e.evaluatedStudentId}`));
        setSubmittedEvals(alreadySubmitted);
        
        setCurrentUser({ ...student, name: studentName });
        setUserRole('student');
        setView('student-eval');
      };

      const handleLogout = async () => {
        if (userRole === 'instructor') {
          await window.firebaseAuth.signOut(window.auth);
        }
        setCurrentUser(null);
        setUserRole(null);
        setView('login');
      };

      const deleteItem = async (type, id) => {
        try {
          const { doc, deleteDoc } = window.firebaseFirestore;
          await deleteDoc(doc(window.db, type, id));
          setSuccess(`${type.slice(0, -1)} deleted successfully`);
          setDeleteConfirm(null);
          loadInstructorData(currentUser.uid);
        } catch (err) {
          setError('Failed to delete item');
        }
      };

      const addCourse = async () => {
        if (!courseName.trim()) return;
        setError('');
        try {
          const { collection, addDoc, serverTimestamp } = window.firebaseFirestore;
          await addDoc(collection(window.db, 'courses'), {
            name: courseName,
            instructorId: currentUser.uid,
            createdAt: serverTimestamp()
          });
          setCourseName('');
          setSuccess('Course added successfully');
          loadInstructorData(currentUser.uid);
        } catch (err) {
          setError('Failed to add course');
        }
      };

      const addSection = async () => {
        if (!sectionName.trim() || !selectedCourse) {
          setError('Please select a course and enter section name');
          return;
        }
        setError('');
        try {
          const { collection, addDoc, serverTimestamp } = window.firebaseFirestore;
          await addDoc(collection(window.db, 'sections'), {
            name: sectionName,
            courseId: selectedCourse,
            createdAt: serverTimestamp()
          });
          setSectionName('');
          setSuccess('Section added successfully');
          loadInstructorData(currentUser.uid);
        } catch (err) {
          setError('Failed to add section');
        }
      };

      const submitPresentationEval = async (evaluatedStudentId, score) => {
        if (score < 1 || score > 10) {
          setError('Score must be between 1 and 10');
          return;
        }

        try {
          const { collection, addDoc, serverTimestamp } = window.firebaseFirestore;
          await addDoc(collection(window.db, 'evaluations'), {
            evaluatorEmail: currentUser.email,
            evaluatedStudentId,
            sectionId: selectedSection,
            type: 'presentation',
            score: parseInt(score),
            timestamp: serverTimestamp()
          });
          
          setSubmittedEvals(prev => new Set([...prev, `presentation-${evaluatedStudentId}`]));
          setPresentationScores(prev => ({ ...prev, [evaluatedStudentId]: '' }));
          setSuccess('Evaluation submitted');
        } catch (err) {
          setError('Failed to submit evaluation');
        }
      };

      const submitGroupEval = async (evaluatedStudentId, score) => {
        if (score < 1 || score > 10) {
          setError('Score must be between 1 and 10');
          return;
        }

        try {
          const { collection, addDoc, serverTimestamp } = window.firebaseFirestore;
          await addDoc(collection(window.db, 'evaluations'), {
            evaluatorEmail: currentUser.email,
            evaluatedStudentId,
            sectionId: selectedSection,
            type: 'group',
            score: parseInt(score),
            timestamp: serverTimestamp()
          });
          
          setSubmittedEvals(prev => new Set([...prev, `group-${evaluatedStudentId}`]));
          setGroupScores(prev => ({ ...prev, [evaluatedStudentId]: '' }));
          setSuccess('Group evaluation submitted');
        } catch (err) {
          setError('Failed to submit evaluation');
        }
      };

      const exportToCSV = () => {
        if (!selectedSection) {
          setError('Please select a section first');
          return;
        }

        const sectionStudents = students.filter(s => s.sectionId === selectedSection);
        const csvRows = ['Student Name,Student ID,Email,Presentation Avg,Presentation Count,Group Avg,Group Count,Overall Avg,Total Evals'];
        
        sectionStudents.forEach(student => {
          const presentationEvals = evaluations.filter(e => 
            e.evaluatedStudentId === student.id && e.type === 'presentation'
          );
          const groupEvals = evaluations.filter(e => 
            e.evaluatedStudentId === student.id && e.type === 'group'
          );
          
          const presAvg = presentationEvals.length > 0
            ? (presentationEvals.reduce((sum, e) => sum + e.score, 0) / presentationEvals.length).toFixed(2)
            : 'N/A';
          const groupAvg = groupEvals.length > 0
            ? (groupEvals.reduce((sum, e) => sum + e.score, 0) / groupEvals.length).toFixed(2)
            : 'N/A';
          
          const allEvals = [...presentationEvals, ...groupEvals];
          const overall = allEvals.length > 0
            ? (allEvals.reduce((sum, e) => sum + e.score, 0) / allEvals.length).toFixed(2)
            : 'N/A';
          
          csvRows.push(
            `"${student.name}","${student.studentId}","${student.email}",${presAvg},${presentationEvals.length},${groupAvg},${groupEvals.length},${overall},${allEvals.length}`
          );
        });
        
        const blob = new Blob([csvRows.join('\n')], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        const sectionName = sections.find(s => s.id === selectedSection)?.name || selectedSection;
        a.download = `evalflow_${sectionName.replace(/\s/g, '_')}_${new Date().toISOString().split('T')[0]}.csv`;
        a.click();
        setSuccess('CSV exported successfully');
      };

      const updatePresentationOrder = async (studentId, newOrder) => {
        try {
          const { doc, updateDoc } = window.firebaseFirestore;
          await updateDoc(doc(window.db, 'students', studentId), {
            presentationOrder: parseInt(newOrder)
          });
          loadInstructorData(currentUser.uid);
        } catch (err) {
          setError('Failed to update order');
        }
      };

      // Bulk Import Functions
      const handleImportFileChange = (e) => {
        const file = e.target.files[0];
        if (file) {
          setImportFile(file);
          parseImportFile(file);
        }
      };

      const parseImportFile = (file) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          try {
            const text = e.target.result;
            const lines = text.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().toLowerCase());
            
            const data = [];
            for (let i = 1; i < lines.length; i++) {
              if (!lines[i].trim()) continue;
              const values = lines[i].split(',').map(v => v.trim());
              const row = {};
              headers.forEach((header, index) => {
                row[header] = values[index] || '';
              });
              data.push(row);
            }
            
            setImportPreview(data);
            setError('');
          } catch (err) {
            setError('Failed to parse file');
          }
        };
        reader.readAsText(file);
      };

      const handleBulkImport = async () => {
        if (!importPreview.length) {
          setError('No data to import');
          return;
        }
        
        setImporting(true);
        setImportProgress('Starting import...');
        let imported = 0;
        let skipped = 0;
        
        try {
          const { collection, addDoc, serverTimestamp } = window.firebaseFirestore;
          
          for (let i = 0; i < importPreview.length; i++) {
            const student = importPreview[i];
            setImportProgress(`Importing ${i + 1} of ${importPreview.length}...`);
            
            const sectionName = student.section || student.sectionname || student['section name'];
            const section = sections.find(s => 
              s.name.toLowerCase().includes(sectionName.toLowerCase())
            );
            
            if (!section) {
              console.warn(`Section not found: ${sectionName}`);
              skipped++;
              continue;
            }
            
            await addDoc(collection(window.db, 'students'), {
              name: student.name || student.studentname || '',
              email: (student.email || '').toLowerCase(),
              studentId: student.id || student.studentid || student['student id'] || '',
              sectionId: section.id,
              presentationOrder: parseInt(student.order || student.presentationorder || '999'),
              createdAt: serverTimestamp()
            });
            
            imported++;
            await new Promise(resolve => setTimeout(resolve, 100));
          }
          
          setSuccess(`Import complete! Added ${imported} students. Skipped ${skipped}.`);
          setImportProgress('');
          setImportPreview([]);
          setImportFile(null);
          setShowBulkImport(false);
          loadInstructorData(currentUser.uid);
        } catch (err) {
          setError('Import failed: ' + err.message);
        } finally {
          setImporting(false);
        }
      };

      const downloadTemplate = () => {
        const template = `Name,Email,Student ID,Section,Order,Group
John Doe,john@university.edu,12345,Section 11,1,1
Jane Smith,jane@university.edu,12346,Section 11,2,1
Bob Johnson,bob@university.edu,12347,Section 12,3,2`;
        
        const blob = new Blob([template], { type: 'text/csv' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'evalflow_import_template.csv';
        a.click();
      };

      if (loading) {
        return React.createElement('div', { className: "min-h-screen bg-gray-50 flex items-center justify-center" },
          React.createElement('div', { className: "text-center" },
            React.createElement('div', { className: "animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto" }),
            React.createElement('p', { className: "mt-4 text-gray-600" }, 'Loading EvalFlow...')
          )
        );
      }

      // LOGIN VIEW
      if (!currentUser || view === 'login') {
        return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4" },
          React.createElement('div', { className: "bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full" },
            React.createElement('div', { className: "text-center mb-8" },
              React.createElement('h1', { className: "text-4xl font-bold text-indigo-600 mb-2" }, 'EvalFlow'),
              React.createElement('p', { className: "text-gray-600" }, 'Professional Peer Evaluation System')
            ),
            
            error && React.createElement('div', { className: "mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm" }, error),
            
            React.createElement('div', { className: "space-y-4" },
              React.createElement('div', { className: "flex gap-2" },
                React.createElement('button', {
                  onClick: () => setView('login'),
                  className: `flex-1 py-2 rounded-lg font-medium transition ${view === 'login' ? 'bg-indigo-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`
                }, 'Instructor'),
                React.createElement('button', {
                  onClick: () => setView('student-login'),
                  className: `flex-1 py-2 rounded-lg font-medium transition ${view === 'student-login' ? 'bg-green-600 text-white' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'}`
                }, 'Student')
              ),

              view === 'login' ? 
                React.createElement('form', { onSubmit: handleInstructorLogin, className: "space-y-4" },
                  React.createElement('input', {
                    type: "email",
                    placeholder: "Instructor Email",
                    value: loginEmail,
                    onChange: (e) => setLoginEmail(e.target.value),
                    required: true,
                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                  }),
                  React.createElement('input', {
                    type: showPassword ? 'text' : 'password',
                    placeholder: "Password",
                    value: loginPassword,
                    onChange: (e) => setLoginPassword(e.target.value),
                    required: true,
                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"
                  }),
                  React.createElement('button', {
                    type: "submit",
                    className: "w-full bg-indigo-600 text-white py-3 rounded-lg font-medium hover:bg-indigo-700 transition"
                  }, 'Login as Instructor')
                ) :
                React.createElement('form', { onSubmit: handleStudentLogin, className: "space-y-4" },
                  React.createElement('input', {
                    type: "text",
                    placeholder: "Your Full Name",
                    value: studentName,
                    onChange: (e) => setStudentName(e.target.value),
                    required: true,
                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  }),
                  React.createElement('input', {
                    type: "email",
                    placeholder: "Your University Email",
                    value: studentEmail,
                    onChange: (e) => setStudentEmail(e.target.value),
                    required: true,
                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  }),
                  React.createElement('select', {
                    value: selectedSection || '',
                    onChange: (e) => setSelectedSection(e.target.value),
                    required: true,
                    className: "w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  },
                    React.createElement('option', { value: "" }, 'Select Your Section'),
                    sections.map(sec => React.createElement('option', { key: sec.id, value: sec.id }, sec.name))
                  ),
                  React.createElement('button', {
                    type: "submit",
                    className: "w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 transition"
                  }, 'Continue to Evaluation')
                )
            )
          )
        );
      }

      // INSTRUCTOR DASHBOARD
      if (userRole === 'instructor') {
        return React.createElement('div', { className: "min-h-screen bg-gray-50" },
          React.createElement('nav', { className: "bg-white shadow-sm border-b sticky top-0 z-50" },
            React.createElement('div', { className: "max-w-7xl mx-auto px-4 py-4 flex justify-between items-center" },
              React.createElement('div', null,
                React.createElement('h1', { className: "text-2xl font-bold text-indigo-600" }, 'EvalFlow'),
                React.createElement('p', { className: "text-sm text-gray-500" }, 'Instructor Panel')
              ),
              React.createElement('button', {
                onClick: handleLogout,
                className: "flex items-center gap-2 px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg transition"
              },
                React.createElement(LogOut, { size: 20 }),
                'Logout'
              )
            )
          ),

          (error || success) && React.createElement('div', { className: "max-w-7xl mx-auto px-4 pt-4" },
            error && React.createElement('div', { className: "mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex justify-between items-center" },
              error,
              React.createElement('button', { onClick: () => setError('') }, React.createElement(X, { size: 16 }))
            ),
            success && React.createElement('div', { className: "mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm flex justify-between items-center" },
              success,
              React.createElement('button', { onClick: () => setSuccess('') }, React.createElement(X, { size: 16 }))
            )
          ),

          React.createElement('div', { className: "max-w-7xl mx-auto px-4 py-8" },
            React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-4 gap-6 mb-8" },
              React.createElement('div', { className: "bg-white p-6 rounded-xl shadow-sm" },
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('div', { className: "bg-blue-100 p-3 rounded-lg" },
                    React.createElement(Users, { size: 24, className: "text-blue-600" })
                  ),
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-gray-500 text-sm" }, 'Students'),
                    React.createElement('p', { className: "text-2xl font-bold" }, students.length)
                  )
                )
              ),
              React.createElement('div', { className: "bg-white p-6 rounded-xl shadow-sm" },
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('div', { className: "bg-green-100 p-3 rounded-lg" },
                    React.createElement(BarChart3, { size: 24, className: "text-green-600" })
                  ),
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-gray-500 text-sm" }, 'Sections'),
                    React.createElement('p', { className: "text-2xl font-bold" }, sections.length)
                  )
                )
              ),
              React.createElement('div', { className: "bg-white p-6 rounded-xl shadow-sm" },
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('div', { className: "bg-purple-100 p-3 rounded-lg" },
                    React.createElement('div', { className: "w-6 h-6 text-purple-600" }, '👥')
                  ),
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-gray-500 text-sm" }, 'Groups'),
                    React.createElement('p', { className: "text-2xl font-bold" }, groups.length)
                  )
                )
              ),
              React.createElement('div', { className: "bg-white p-6 rounded-xl shadow-sm" },
                React.createElement('div', { className: "flex items-center gap-4" },
                  React.createElement('div', { className: "bg-orange-100 p-3 rounded-lg" },
                    React.createElement(FileDown, { size: 24, className: "text-orange-600" })
                  ),
                  React.createElement('div', null,
                    React.createElement('p', { className: "text-gray-500 text-sm" }, 'Evaluations'),
                    React.createElement('p', { className: "text-2xl font-bold" }, evaluations.length)
                  )
                )
              )
            ),

            React.createElement('div', { className: "bg-white rounded-xl shadow-sm mb-6" },
              React.createElement('div', { className: "flex border-b overflow-x-auto" },
                ['courses', 'students', 'export'].map(tab =>
                  React.createElement('button', {
                    key: tab,
                    onClick: () => setActiveTab(tab),
                    className: `px-6 py-4 font-medium capitalize whitespace-nowrap ${activeTab === tab ? 'border-b-2 border-indigo-600 text-indigo-600' : 'text-gray-600 hover:text-indigo-600'}`
                  }, tab)
                )
              ),

              React.createElement('div', { className: "p-6" },
                activeTab === 'courses' && React.createElement('div', { className: "space-y-6" },
                  React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, 'Add Course'),
                    React.createElement('div', { className: "flex gap-2" },
                      React.createElement('input', {
                        type: "text",
                        value: courseName,
                        onChange: (e) => setCourseName(e.target.value),
                        placeholder: "e.g., Public Speaking 101",
                        className: "flex-1 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500"
                      }),
                      React.createElement('button', {
                        onClick: addCourse,
                        className: "px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"
                      }, '+ Add')
                    )
                  ),

                  React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, 'Courses'),
                    React.createElement('div', { className: "space-y-2" },
                      courses.map(course =>
                        React.createElement('div', { key: course.id, className: "p-4 border rounded-lg hover:bg-gray-50 flex justify-between items-center" },
                          React.createElement('div', null,
                            React.createElement('p', { className: "font-medium" }, course.name),
                            React.createElement('p', { className: "text-sm text-gray-500" },
                              sections.filter(s => s.courseId === course.id).length, ' sections'
                            )
                          ),
                          React.createElement('button', {
                            onClick: () => setDeleteConfirm({ type: 'courses', id: course.id, name: course.name }),
                            className: "p-2 text-red-600 hover:bg-red-50 rounded"
                          }, React.createElement(Trash2, { size: 18 }))
                        )
                      )
                    )
                  ),

                  React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, 'Add Section'),
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-2" },
                      React.createElement('select', {
                        value: selectedCourse || '',
                        onChange: (e) => setSelectedCourse(e.target.value),
                        className: "px-4 py-2 border rounded-lg"
                      },
                        React.createElement('option', { value: "" }, 'Select Course'),
                        courses.map(c => React.createElement('option', { key: c.id, value: c.id }, c.name))
                      ),
                      React.createElement('input', {
                        type: "text",
                        value: sectionName,
                        onChange: (e) => setSectionName(e.target.value),
                        placeholder: "Section 11",
                        className: "px-4 py-2 border rounded-lg"
                      }),
                      React.createElement('button', {
                        onClick: addSection,
                        className: "px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700"
                      }, 'Add Section')
                    )
                  ),

                  React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, 'Sections'),
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 gap-4" },
                      sections.map(section =>
                        React.createElement('div', { key: section.id, className: "p-4 border rounded-lg hover:bg-gray-50 flex justify-between items-center" },
                          React.createElement('div', null,
                            React.createElement('p', { className: "font-medium" }, section.name),
                            React.createElement('p', { className: "text-sm text-gray-500" },
                              students.filter(s => s.sectionId === section.id).length, ' students'
                            )
                          ),
                          React.createElement('button', {
                            onClick: () => setDeleteConfirm({ type: 'sections', id: section.id, name: section.name }),
                            className: "p-2 text-red-600 hover:bg-red-50 rounded"
                          }, React.createElement(Trash2, { size: 18 }))
                        )
                      )
                    )
                  )
                ),

                activeTab === 'students' && React.createElement('div', { className: "space-y-6" },
                  React.createElement('div', { className: "flex justify-between items-center flex-wrap gap-4" },
                    React.createElement('h3', { className: "text-lg font-semibold" }, 'Manage Students'),
                    React.createElement('div', { className: "flex gap-2" },
                      React.createElement('button', {
                        onClick: () => setShowBulkImport(true),
                        className: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center gap-2"
                      },
                        React.createElement(Upload, { size: 18 }),
                        'Bulk Import'
                      ),
                      React.createElement('select', {
                        value: selectedSection || '',
                        onChange: (e) => setSelectedSection(e.target.value),
                        className: "px-4 py-2 border rounded-lg"
                      },
                        React.createElement('option', { value: "" }, 'All Sections'),
                        sections.map(s => React.createElement('option', { key: s.id, value: s.id }, s.name))
                      )
                    )
                  ),

                  React.createElement('div', { className: "overflow-x-auto" },
                    React.createElement('table', { className: "w-full" },
                      React.createElement('thead', { className: "bg-gray-50" },
                        React.createElement('tr', null,
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Name'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'ID'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Email'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Section'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Order'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Evals'),
                          React.createElement('th', { className: "px-4 py-3 text-left text-sm font-medium text-gray-700" }, 'Actions')
                        )
                      ),
                      React.createElement('tbody', { className: "divide-y" },
                        students
                          .filter(s => !selectedSection || s.sectionId === selectedSection)
                          .sort((a, b) => a.presentationOrder - b.presentationOrder)
                          .map(student => {
                            const studentEvals = evaluations.filter(e => e.evaluatedStudentId === student.id);
                            return React.createElement('tr', { key: student.id, className: "hover:bg-gray-50" },
                              React.createElement('td', { className: "px-4 py-3" }, student.name),
                              React.createElement('td', { className: "px-4 py-3" }, student.studentId),
                              React.createElement('td', { className: "px-4 py-3 text-sm" }, student.email),
                              React.createElement('td', { className: "px-4 py-3 text-sm" },
                                sections.find(s => s.id === student.sectionId)?.name
                              ),
                              React.createElement('td', { className: "px-4 py-3" },
                                React.createElement('input', {
                                  type: "number",
                                  value: student.presentationOrder,
                                  onChange: (e) => updatePresentationOrder(student.id, e.target.value),
                                  className: "w-16 px-2 py-1 border rounded text-center"
                                })
                              ),
                              React.createElement('td', { className: "px-4 py-3" },
                                React.createElement('span', { className: "px-2 py-1 bg-green-100 text-green-700 rounded-full text-xs" },
                                  studentEvals.length
                                )
                              ),
                              React.createElement('td', { className: "px-4 py-3" },
                                React.createElement('button', {
                                  onClick: () => setDeleteConfirm({ type: 'students', id: student.id, name: student.name }),
                                  className: "p-1 text-red-600 hover:bg-red-50 rounded"
                                }, React.createElement(Trash2, { size: 16 }))
                              )
                            );
                          })
                      )
                    )
                  )
                ),

                activeTab === 'export' && React.createElement('div', { className: "space-y-6" },
                  React.createElement('div', null,
                    React.createElement('h3', { className: "text-lg font-semibold mb-4" }, 'Export Evaluations'),
                    React.createElement('div', { className: "flex gap-2 mb-6 flex-wrap" },
                      React.createElement('select', {
                        value: selectedSection || '',
                        onChange: (e) => setSelectedSection(e.target.value),
                        className: "flex-1 min-w-[200px] px-4 py-2 border rounded-lg"
                      },
                        React.createElement('option', { value: "" }, 'Select Section to Export'),
                        sections.map(s => React.createElement('option', { key: s.id, value: s.id }, s.name))
                      ),
                      React.createElement('button', {
                        onClick: exportToCSV,
                        disabled: !selectedSection,
                        className: "px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2"
                      },
                        React.createElement(FileDown, { size: 18 }),
                        'Export CSV'
                      )
                    )
                  ),

                  selectedSection && React.createElement('div', { className: "bg-gray-50 rounded-lg p-6 overflow-x-auto" },
                    React.createElement('h4', { className: "font-semibold mb-4" },
                      'Preview: ', sections.find(s => s.id === selectedSection)?.name
                    ),
                    React.createElement('table', { className: "w-full text-sm" },
                      React.createElement('thead', { className: "bg-white" },
                        React.createElement('tr', null,
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'Student'),
                          React.createElement('th', { className: "px-3 py-2 text-center" }, 'Pres. Avg'),
                          React.createElement('th', { className: "px-3 py-2 text-center" }, 'Group Avg'),
                          React.createElement('th', { className: "px-3 py-2 text-center" }, 'Overall'),
                          React.createElement('th', { className: "px-3 py-2 text-center" }, 'Total')
                        )
                      ),
                      React.createElement('tbody', { className: "divide-y" },
                        students
                          .filter(s => s.sectionId === selectedSection)
                          .map(student => {
                            const presEvals = evaluations.filter(e => e.evaluatedStudentId === student.id && e.type === 'presentation');
                            const groupEvals = evaluations.filter(e => e.evaluatedStudentId === student.id && e.type === 'group');
                            const presAvg = presEvals.length > 0 ? (presEvals.reduce((sum, e) => sum + e.score, 0) / presEvals.length).toFixed(2) : 'N/A';
                            const groupAvg = groupEvals.length > 0 ? (groupEvals.reduce((sum, e) => sum + e.score, 0) / groupEvals.length).toFixed(2) : 'N/A';
                            const allEvals = [...presEvals, ...groupEvals];
                            const overall = allEvals.length > 0 ? (allEvals.reduce((sum, e) => sum + e.score, 0) / allEvals.length).toFixed(2) : 'N/A';
                            
                            return React.createElement('tr', { key: student.id, className: "bg-white" },
                              React.createElement('td', { className: "px-3 py-2" }, student.name),
                              React.createElement('td', { className: "px-3 py-2 text-center" }, presAvg),
                              React.createElement('td', { className: "px-3 py-2 text-center" }, groupAvg),
                              React.createElement('td', { className: "px-3 py-2 text-center font-semibold" }, overall),
                              React.createElement('td', { className: "px-3 py-2 text-center" }, allEvals.length)
                            );
                          })
                      )
                    )
                  )
                )
              )
            )
          ),

          // Delete Confirmation Modal
          deleteConfirm && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" },
            React.createElement('div', { className: "bg-white rounded-xl p-6 max-w-md w-full" },
              React.createElement('h3', { className: "text-lg font-bold mb-2" }, 'Confirm Delete'),
              React.createElement('p', { className: "text-gray-600 mb-6" },
                'Are you sure you want to delete "', deleteConfirm.name, '"? This action cannot be undone.'
              ),
              React.createElement('div', { className: "flex gap-3" },
                React.createElement('button', {
                  onClick: () => setDeleteConfirm(null),
                  className: "flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50"
                }, 'Cancel'),
                React.createElement('button', {
                  onClick: () => deleteItem(deleteConfirm.type, deleteConfirm.id),
                  className: "flex-1 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700"
                }, 'Delete')
              )
            )
          ),

          // Bulk Import Modal
          showBulkImport && React.createElement('div', { className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-y-auto" },
            React.createElement('div', { className: "bg-white rounded-xl p-8 max-w-4xl w-full my-8" },
              React.createElement('div', { className: "flex justify-between items-center mb-6" },
                React.createElement('h2', { className: "text-2xl font-bold" }, 'Bulk Import Students'),
                React.createElement('button', {
                  onClick: () => setShowBulkImport(false),
                  className: "p-2 hover:bg-gray-100 rounded"
                }, React.createElement(X, { size: 24 }))
              ),

              importProgress && React.createElement('div', { className: "mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-700" },
                importProgress
              ),

              React.createElement('div', { className: "space-y-6" },
                React.createElement('div', { className: "bg-blue-50 border border-blue-200 rounded-lg p-4" },
                  React.createElement('h3', { className: "font-semibold text-blue-900 mb-2" }, 'CSV Format:'),
                  React.createElement('div', { className: "bg-white rounded p-2 font-mono text-xs overflow-x-auto mb-3" },
                    React.createElement('div', { className: "font-bold" }, 'Name,Email,Student ID,Section,Order,Group'),
                    React.createElement('div', null, 'John Doe,john@univ.edu,12345,Section 11,1,1')
                  ),
                  React.createElement('button', {
                    onClick: downloadTemplate,
                    className: "px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm"
                  }, 'Download Template')
                ),

                React.createElement('div', { className: "border-2 border-dashed border-gray-300 rounded-lg p-6 text-center" },
                  React.createElement('input', {
                    type: "file",
                    accept: ".csv",
                    onChange: handleImportFileChange,
                    className: "hidden",
                    id: "bulk-upload"
                  }),
                  React.createElement('label', {
                    htmlFor: "bulk-upload",
                    className: "cursor-pointer inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700"
                  },
                    React.createElement(Upload, { size: 18 }),
                    'Choose CSV File'
                  ),
                  importFile && React.createElement('p', { className: "mt-3 text-gray-600 text-sm" },
                    'Selected: ', importFile.name
                  )
                ),

                importPreview.length > 0 && React.createElement('div', null,
                  React.createElement('h3', { className: "font-semibold mb-3" },
                    'Preview (', importPreview.length, ' students)'
                  ),
                  React.createElement('div', { className: "max-h-96 overflow-auto border rounded-lg" },
                    React.createElement('table', { className: "w-full text-sm" },
                      React.createElement('thead', { className: "bg-gray-50 sticky top-0" },
                        React.createElement('tr', null,
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'Name'),
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'Email'),
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'ID'),
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'Section'),
                          React.createElement('th', { className: "px-3 py-2 text-left" }, 'Order')
                        )
                      ),
                      React.createElement('tbody', { className: "divide-y" },
                        importPreview.slice(0, 50).map((student, idx) =>
                          React.createElement('tr', { key: idx, className: "hover:bg-gray-50" },
                            React.createElement('td', { className: "px-3 py-2" }, student.name),
                            React.createElement('td', { className: "px-3 py-2" }, student.email),
                            React.createElement('td', { className: "px-3 py-2" }, student.id || student.studentid),
                            React.createElement('td', { className: "px-3 py-2" }, student.section),
                            React.createElement('td', { className: "px-3 py-2" }, student.order || '-')
                          )
                        )
                      )
                    )
                  ),

                  React.createElement('div', { className: "flex gap-3 mt-4" },
                    React.createElement('button', {
                      onClick: handleBulkImport,
                      disabled: importing,
                      className: "flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 disabled:opacity-50"
                    }, importing ? 'Importing...' : `Import ${importPreview.length} Students`),
                    React.createElement('button', {
                      onClick: () => {
                        setImportPreview([]);
                        setImportFile(null);
                      },
                      className: "px-6 py-3 border rounded-lg hover:bg-gray-50"
                    }, 'Cancel')
                  )
                )
              )
            )
          )
        );
      }

      // STUDENT VIEW
      return React.createElement('div', { className: "min-h-screen bg-gradient-to-br from-green-50 to-blue-50" },
        React.createElement('nav', { className: "bg-white shadow-sm border-b sticky top-0 z-50" },
          React.createElement('div', { className: "max-w-4xl mx-auto px-4 py-4 flex justify-between items-center" },
            React.createElement('div', null,
              React.createElement('h1', { className: "text-xl font-bold text-green-600" }, 'EvalFlow'),
              React.createElement('p', { className: "text-sm text-gray-600" }, 'Welcome, ', currentUser.name)
            ),
            React.createElement('button', {
              onClick: handleLogout,
              className: "px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-lg flex items-center gap-2"
            },
              React.createElement(LogOut, { size: 18 }),
              'Logout'
            )
          )
        ),

        (error || success) && React.createElement('div', { className: "max-w-4xl mx-auto px-4 pt-4" },
          error && React.createElement('div', { className: "mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm flex justify-between items-center" },
            error,
            React.createElement('button', { onClick: () => setError('') }, React.createElement(X, { size: 16 }))
          ),
          success && React.createElement('div', { className: "mb-4 p-3 bg-green-50 border border-green-200 rounded-lg text-green-700 text-sm flex justify-between items-center" },
            success,
            React.createElement('button', { onClick: () => setSuccess('') }, React.createElement(X, { size: 16 }))
          )
        ),

        React.createElement('div', { className: "max-w-4xl mx-auto px-4 py-8" },
          React.createElement('div', { className: "bg-white rounded-xl shadow-lg p-6 md:p-8" },
            React.createElement('h2', { className: "text-2xl font-bold mb-6" }, 'Peer Evaluations'),
            
            React.createElement('div', { className: "mb-8" },
              React.createElement('h3', { className: "text-lg font-semibold mb-2 text-indigo-600 flex items-center gap-2" },
                React.createElement(BarChart3, { size: 20 }),
                'Presentation Evaluations'
              ),
              React.createElement('p', { className: "text-sm text-gray-600 mb-4" },
                'Rate each presenter as they present (1-10 scale)'
              ),
              
              React.createElement('div', { className: "space-y-3" },
                students
                  .filter(s => s.sectionId === selectedSection && s.id !== currentUser.id)
                  .sort((a, b) => a.presentationOrder - b.presentationOrder)
                  .map(student => {
                    const isSubmitted = submittedEvals.has(`presentation-${student.id}`);
                    return React.createElement('div', {
                      key: student.id,
                      className: `border rounded-lg p-4 ${isSubmitted ? 'bg-gray-50' : 'bg-white'}`
                    },
                      React.createElement('div', { className: "flex justify-between items-center flex-wrap gap-2" },
                        React.createElement('div', null,
                          React.createElement('p', { className: "font-medium" }, student.name),
                          React.createElement('p', { className: "text-sm text-gray-500" }, 'Order: #', student.presentationOrder)
                        ),
                        isSubmitted ?
                          React.createElement('div', { className: "px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium" },
                            '✓ Submitted'
                          ) :
                          React.createElement('div', { className: "flex gap-2" },
                            React.createElement('input', {
                              type: "number",
                              min: "1",
                              max: "10",
                              placeholder: "1-10",
                              value: presentationScores[student.id] || '',
                              onChange: (e) => setPresentationScores({
                                ...presentationScores,
                                [student.id]: e.target.value
                              }),
                              className: "w-20 px-3 py-2 border rounded-lg text-center"
                            }),
                            React.createElement('button', {
                              onClick: () => submitPresentationEval(student.id, presentationScores[student.id]),
                              disabled: !presentationScores[student.id],
                              className: "px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:opacity-50"
                            }, 'Submit')
                          )
                      )
                    );
                  })
              )
            ),

            React.createElement('div', { className: "border-t pt-6" },
              React.createElement('h3', { className: "text-lg font-semibold mb-2 text-green-600 flex items-center gap-2" },
                React.createElement(Users, { size: 20 }),
                'Group Member Evaluations'
              ),
              React.createElement('p', { className: "text-sm text-gray-600 mb-4" },
                'Rate your group members\' contributions (1-10 scale)'
              ),
              
              (() => {
                const studentGroups = groups.filter(g => 
                  g.sectionId === selectedSection && 
                  (g.members || []).includes(currentUser.id)
                );
                
                if (studentGroups.length === 0) {
                  return React.createElement('div', { className: "text-center py-8 bg-gray-50 rounded-lg" },
                    React.createElement(Users, { size: 48, className: "mx-auto text-gray-300 mb-2" }),
                    React.createElement('p', { className: "text-gray-500" }, 'You haven\'t been assigned to a group yet')
                  );
                }

                return studentGroups.map(group =>
                  React.createElement('div', { key: group.id, className: "mb-6" },
                    React.createElement('h4', { className: "font-medium mb-3 text-gray-700" }, group.name),
                    React.createElement('div', { className: "space-y-3" },
                      (group.members || [])
                        .filter(memberId => memberId !== currentUser.id)
                        .map(memberId => {
                          const member = students.find(s => s.id === memberId);
                          if (!member) return null;
                          
                          const isSubmitted = submittedEvals.has(`group-${member.id}`);
                          return React.createElement('div', {
                            key: member.id,
                            className: `border rounded-lg p-4 ${isSubmitted ? 'bg-gray-50' : 'bg-white'}`
                          },
                            React.createElement('div', { className: "flex justify-between items-center flex-wrap gap-2" },
                              React.createElement('p', { className: "font-medium" }, member.name),
                              isSubmitted ?
                                React.createElement('div', { className: "px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium" },
                                  '✓ Submitted'
                                ) :
                                React.createElement('div', { className: "flex gap-2" },
                                  React.createElement('input', {
                                    type: "number",
                                    min: "1",
                                    max: "10",
                                    placeholder: "1-10",
                                    value: groupScores[member.id] || '',
                                    onChange: (e) => setGroupScores({
                                      ...groupScores,
                                      [member.id]: e.target.value
                                    }),
                                    className: "w-20 px-3 py-2 border rounded-lg text-center"
                                  }),
                                  React.createElement('button', {
                                    onClick: () => submitGroupEval(member.id, groupScores[member.id]),
                                    disabled: !groupScores[member.id],
                                    className: "px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50"
                                  }, 'Submit')
                                )
                            )
                          );
                        })
                    )
                  )
                );
              })()
            )
          )
        )
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(React.createElement(EvalFlow));
  </script>
</body>
</html>
